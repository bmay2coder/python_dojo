<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=\, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <h3>Star Wars Blog</h3>
    <h5>Welcome {{user.first_name}}</h5>
    <p><a href="/logout">LOG OUT</a></p>
    {% with messages = get_flashed_messages() %}     <!-- declare a variable called messages -->
        {% if messages %}                            <!-- check if there are any messages -->
            {% for message in messages %}            <!-- loop through the messages -->
                <p style="color: red;">{{message}}</p>                   <!-- display each message in a paragraph tag -->
            {% endfor %}
        {% endif %}
    {% endwith %}
    <hr>
    <h5>What would you like to write in the Star Wars blog?</h5>
    <form action="/star_wars/posts/new" method="POST">
        <input type="textarea" rows="5" name="content">
        <input type="hidden" name="user_id" value="{{user.id}}">
        <input type="submit" value="Publish">
    </form> 
    <hr>
    <h5>All Blogs</h5>
    {% for post in all_posts %}
        <h6>{{post.poster.first_name}} - {{post.created_at}}</h6>
        <p style="padding-left: 16px;">{{post.content}}</p>
        {% if post.poster.id == user.id %}
            <p><a href="/star_wars/posts/{{post.id}}/delete">delete</a></p>
        {% endif %}
        {% for comment in post.comments %}
            <h6 style="padding-left: 32px;">{{comment.commenter.first_name}}: {{comment.comment_text}}</h6>
        {% endfor %}
        <form action="/star_wars/posts/comment" method="POST">
            <input type="text" name="comment_text">
            <input type="hidden" name="user_id" value="{{user.id}}">
            <input type="hidden" name="post_id" value="{{post.id}}">
            <input type="submit" value="Comment">
        </form> 
    {% endfor %}
</body>
</html>